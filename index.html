<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能排班系统</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Main App -->
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1><i class="fas fa-calendar-alt"></i> 排班系统</h1>
                <div class="connection-status" id="connectionStatus">
                    <i class="fas fa-wifi"></i>
                    <span>已连接</span>
                </div>
            </div>
            <div class="current-date">
                <span id="currentDate"></span>
            </div>
        </header>

        <!-- Main Navigation -->
        <nav class="main-nav">
            <button class="nav-btn active" data-view="employees" onclick="switchView('employees')">
                <i class="fas fa-users"></i>
                <span>员工</span>
            </button>
            <button class="nav-btn" data-view="weekly" onclick="switchView('weekly')">
                <i class="fas fa-calendar-week"></i>
                <span>本周</span>
            </button>
            <button class="nav-btn" data-view="schedule" onclick="switchView('schedule')">
                <i class="fas fa-plus-circle"></i>
                <span>排班</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- EMPLOYEES VIEW -->
            <div class="view active" id="employeesView">
                <div class="view-header">
                    <h2><i class="fas fa-users"></i> 员工列表</h2>
                    <button class="btn-icon" onclick="showAddEmployee()">
                        <i class="fas fa-user-plus"></i>
                    </button>
                </div>

                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="employeeSearch" placeholder="搜索员工..." oninput="searchEmployees()">
                </div>

                <div class="employee-cards" id="employeeCards">
                    <!-- 员工卡片 -->
                </div>
            </div>

            <!-- WEEKLY SCHEDULE VIEW -->
            <div class="view" id="weeklyView">
                <div class="view-header">
                    <h2><i class="fas fa-calendar-week"></i> 本周排班</h2>
                    <div class="week-nav">
                        <button class="btn-icon" onclick="changeWeek(-1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="weekRange">本周</span>
                        <button class="btn-icon" onclick="changeWeek(1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="weekly-schedule" id="weeklySchedule">
                    <!-- 周排班表 -->
                </div>
            </div>

            <!-- SCHEDULE VIEW -->
            <div class="view" id="scheduleView">
                <div class="view-header">
                    <h2><i class="fas fa-plus-circle"></i> 添加排班</h2>
                </div>

                <div class="schedule-form">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> 选择员工</label>
                        <select id="scheduleEmployee" class="select-input">
                            <option value="">选择员工</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-calendar"></i> 日期</label>
                        <input type="date" id="scheduleDate" class="input-field">
                    </div>

                    <div class="time-group">
                        <div class="form-group">
                            <label>开始时间</label>
                            <input type="time" id="scheduleStart" class="input-field" value="08:00">
                        </div>
                        <div class="form-group">
                            <label>结束时间</label>
                            <input type="time" id="scheduleEnd" class="input-field" value="17:00">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>类型</label>
                        <div class="type-selector">
                            <button class="type-btn active" data-type="work" onclick="selectType('work')">
                                <i class="fas fa-briefcase"></i>
                                <span>上班</span>
                            </button>
                            <button class="type-btn" data-type="rest" onclick="selectType('rest')">
                                <i class="fas fa-umbrella-beach"></i>
                                <span>休息</span>
                            </button>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn-primary" onclick="addSchedule()">
                            <i class="fas fa-check"></i> 添加排班
                        </button>
                        <button class="btn-secondary" onclick="quickWeekSchedule()">
                            <i class="fas fa-bolt"></i> 快速整周
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Quick Actions Bar -->
        <div class="quick-actions-bar">
            <button class="quick-action" onclick="showTodaySchedule()">
                <i class="fas fa-calendar-day"></i>
                <span>今日</span>
            </button>
            <button class="quick-action" onclick="showEmployeeStats()">
                <i class="fas fa-chart-bar"></i>
                <span>统计</span>
            </button>
            <button class="quick-action primary" onclick="showExportOptions()">
                <i class="fas fa-share"></i>
                <span>分享</span>
            </button>
        </div>
    </div>

    <!-- MODALS -->
    <!-- Employee Detail Modal -->
    <div class="modal" id="employeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalEmployeeName"></h3>
                <button class="modal-close" onclick="closeModal('employeeModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="employee-info">
                    <div class="info-row">
                        <span class="label">职位</span>
                        <span class="value" id="modalEmployeePosition"></span>
                    </div>
                    <div class="info-row">
                        <span class="label">本周工时</span>
                        <span class="value" id="modalWeekHours"></span>
                    </div>
                    <div class="info-row">
                        <span class="label">本月工时</span>
                        <span class="value" id="modalMonthHours"></span>
                    </div>
                </div>

                <div class="weekly-schedule-preview" id="employeeWeekSchedule">
                    <!-- 员工本周排班 -->
                </div>

                <div class="modal-actions">
                    <button class="btn-action" onclick="editEmployeeSchedule()">
                        <i class="fas fa-edit"></i> 编辑排班
                    </button>
                    <button class="btn-action" onclick="showExportEmployeeOptions()">
                        <i class="fas fa-share"></i> 分享排班
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div class="modal" id="addEmployeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> 添加员工</h3>
                <button class="modal-close" onclick="closeModal('addEmployeeModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="text" id="newEmployeeName" class="input-field" placeholder="员工姓名">
                </div>
                <div class="form-group">
                    <label>职位</label>
                    <div class="position-select">
                        <button class="position-option active" data-position="前台/服务区" onclick="selectPosition(this)">
                            <i class="fas fa-door-open"></i>
                            前台/服务区
                        </button>
                        <button class="position-option" data-position="厨房区" onclick="selectPosition(this)">
                            <i class="fas fa-utensils"></i>
                            厨房区
                        </button>
                    </div>
                </div>
                <button class="btn-primary full-width" onclick="addEmployee()">
                    <i class="fas fa-plus"></i> 添加
                </button>
            </div>
        </div>
    </div>

    <!-- Export Options Modal -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share"></i> 分享选项</h3>
                <button class="modal-close" onclick="closeModal('exportModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <button class="export-option" onclick="copyScheduleText()">
                        <i class="fas fa-copy"></i>
                        <div class="option-info">
                            <strong>复制文本</strong>
                            <small>复制为文本格式，可直接粘贴到微信</small>
                        </div>
                    </button>
                    <button class="export-option" onclick="printSchedule()">
                        <i class="fas fa-print"></i>
                        <div class="option-info">
                            <strong>打印排班</strong>
                            <small>打印本周详细排班表</small>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Today's Schedule Modal -->
    <div class="modal" id="todayModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-day"></i> 今日排班</h3>
                <button class="modal-close" onclick="closeModal('todayModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="today-schedule" id="todaySchedule">
                    <!-- 今日排班 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Modal -->
    <div class="modal" id="statsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-chart-bar"></i> 工时统计</h3>
                <button class="modal-close" onclick="closeModal('statsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="stats-grid" id="statsContent">
                    <!-- 统计信息 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Schedule Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> 编辑排班</h3>
                <button class="modal-close" onclick="closeModal('editModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="editScheduleContent">
                    <!-- 编辑排班内容 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Config -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB6C3s4EAPEx0GBLnBXAz4aYJfoCBEyofc",
            authDomain: "employee-schedule-893f5.firebaseapp.com",
            databaseURL: "https://employee-schedule-893f5-default-rtdb.firebaseio.com",
            projectId: "employee-schedule-893f5",
            storageBucket: "employee-schedule-893f5.firebasestorage.app",
            messagingSenderId: "377051530021",
            appId: "1:377051530021:web:e3341a1a7bcdc89ad810cc"
        };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // 连接状态
        database.ref('.info/connected').on('value', (snap) => {
            const status = document.getElementById('connectionStatus');
            if (snap.val() === true) {
                status.innerHTML = '<i class="fas fa-wifi"></i><span>已连接</span>';
                status.className = 'connection-status connected';
            } else {
                status.innerHTML = '<i class="fas fa-wifi-slash"></i><span>未连接</span>';
                status.className = 'connection-status disconnected';
            }
        });
    </script>

    <!-- Main JavaScript -->
    <script src="app.js"></script>
</body>
</html>
