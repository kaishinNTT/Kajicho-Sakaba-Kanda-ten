<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>é›æ²»ç”ºé…’å ´ ç¥ç”°åº— - å‹¤å‹™è¡¨ç®¡ç†</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“…</text></svg>">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“…</text></svg>">
    <style>
        /* Loading screen */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Print optimization */
        @media print {
            body * {
                visibility: hidden;
            }
            
            .app, .app * {
                visibility: visible;
            }
            
            .app {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                max-width: 100%;
                margin: 0;
                padding: 0;
                box-shadow: none;
                border-radius: 0;
            }
            
            .no-print {
                display: none !important;
            }
            
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 15px;
                padding-bottom: 10px;
                border-bottom: 2px solid #2563eb;
            }
            
            .company-name {
                font-size: 22px !important;
                color: #2563eb;
                font-weight: 800;
                margin-bottom: 5px;
            }
            
            .print-date {
                font-size: 14px;
                color: #666;
                font-weight: 600;
            }
            
            .weekly-schedule-container {
                max-height: none !important;
                overflow: visible !important;
                border: none !important;
            }
            
            .weekly-schedule {
                max-height: none !important;
                overflow: visible !important;
            }
            
            .week-header {
                position: static !important;
                background: #e6f0ff !important;
            }
            
            .week-cell:first-child {
                position: static !important;
            }
            
            .day-schedule-item {
                position: relative !important;
                top: auto !important;
                left: auto !important;
                right: auto !important;
                bottom: auto !important;
                margin: 2px;
            }
            
            .compact-time {
                font-size: 9px;
                line-height: 1;
            }
            
            .week-row {
                min-height: auto;
                page-break-inside: avoid;
            }
            
            .week-cell {
                min-height: auto;
                padding: 8px 4px;
            }
            
            .week-cell:first-child {
                min-height: auto;
            }
            
            /* For mobile printing */
            @page {
                margin: 0.5cm;
                size: auto;
            }
            
            body {
                background: white !important;
                padding: 0 !important;
            }
            
            .main-content {
                padding: 10px !important;
                overflow: visible !important;
            }
            
            .view-header h2 {
                font-size: 18px;
                margin-bottom: 10px;
            }
            
            /* Compact display */
            .employee-name {
                font-size: 12px;
            }
            
            .employee-position {
                font-size: 10px;
                padding: 2px 6px;
            }
            
            .stat-item {
                font-size: 10px;
            }
            
            /* Improved print layout for single employee */
            .single-employee-print .week-row {
                min-height: 60px !important;
            }
            
            .single-employee-print .week-cell {
                min-height: 60px !important;
                padding: 4px 2px !important;
            }
            
            .single-employee-print .day-schedule-item {
                padding: 2px !important;
                font-size: 8px !important;
            }
        }
        
        .print-header {
            display: none;
        }
        
        /* Hide dark mode for iPhone */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            }
            
            .app {
                background: white !important;
                color: #333 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loading-spinner"></div>
        <h2>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èª­ã¿è¾¼ã¿ä¸­...</h2>
        <p style="margin-top: 10px; opacity: 0.8;">é›æ²»ç”ºé…’å ´ ç¥ç”°åº— å‹¤å‹™è¡¨</p>
    </div>

    <!-- Main App -->
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-calendar-alt"></i> é›æ²»ç”ºé…’å ´ ç¥ç”°åº—</h1>
                <div class="header-right">
                    <div class="language-switcher no-print">
                        <button class="lang-btn" id="languageSwitch">
                            <i class="fas fa-language"></i>
                            <span id="currentLanguage">æ—¥æœ¬èª</span>
                        </button>
                    </div>
                    <div class="connection-status" id="connectionStatus">
                        <i class="fas fa-wifi"></i>
                        <span>æ¥ç¶šæ¸ˆã¿</span>
                    </div>
                </div>
            </div>
            <div class="current-date" id="currentDate"></div>
        </header>

        <!-- Print Header (only for printing) -->
        <div class="print-header">
            <div class="company-name">é›æ²»ç”ºé…’å ´ ç¥ç”°åº—</div>
            <div class="print-date" id="printDate"></div>
        </div>

        <!-- Main Navigation -->
        <nav class="main-nav no-print">
            <button class="nav-btn active" data-view="employees" onclick="switchView('employees')">
                <i class="fas fa-users"></i>
                <span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•</span>
                <span data-lang="zh" style="display:none">å‘˜å·¥</span>
            </button>
            <button class="nav-btn" data-view="weekly" onclick="switchView('weekly')">
                <i class="fas fa-calendar-week"></i>
                <span data-lang="ja">ä»Šé€±</span>
                <span data-lang="zh" style="display:none">æœ¬å‘¨</span>
            </button>
            <button class="nav-btn" data-view="schedule" onclick="switchView('schedule')">
                <i class="fas fa-plus-circle"></i>
                <span data-lang="ja">ã‚·ãƒ•ãƒˆç™»éŒ²</span>
                <span data-lang="zh" style="display:none">æ’ç­</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- EMPLOYEES VIEW -->
            <div class="view active" id="employeesView">
                <div class="view-header">
                    <h2><i class="fas fa-users"></i> <span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†</span><span data-lang="zh" style="display:none">å‘˜å·¥ç®¡ç†</span></h2>
                    <div class="view-actions">
                        <button class="btn-icon" onclick="showAddEmployee()" title="ã‚¹ã‚¿ãƒƒãƒ•è¿½åŠ ">
                            <i class="fas fa-user-plus"></i>
                        </button>
                        <button class="btn-icon" onclick="refreshData()" title="æ›´æ–°">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>

                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="employeeSearch" placeholder="ã‚¹ã‚¿ãƒƒãƒ•ã‚’æ¤œç´¢..." oninput="searchEmployees()">
                </div>

                <div class="position-filter">
                    <button class="filter-btn active" onclick="filterEmployees('all')">
                        <span data-lang="ja">å…¨ã¦</span>
                        <span data-lang="zh" style="display:none">å…¨éƒ¨</span>
                    </button>
                    <button class="filter-btn" onclick="filterEmployees('å‰å°/æœåŠ¡åŒº')">
                        <span data-lang="ja">ãƒ•ãƒ­ãƒ³ãƒˆ</span>
                        <span data-lang="zh" style="display:none">å‰å°</span>
                    </button>
                    <button class="filter-btn" onclick="filterEmployees('å¨æˆ¿åŒº')">
                        <span data-lang="ja">å¨æˆ¿</span>
                        <span data-lang="zh" style="display:none">å¨æˆ¿</span>
                    </button>
                </div>

                <div class="employee-cards" id="employeeCards">
                    <!-- ã‚¹ã‚¿ãƒƒãƒ•ã‚«ãƒ¼ãƒ‰ -->
                </div>
            </div>

            <!-- WEEKLY SCHEDULE VIEW -->
            <div class="view" id="weeklyView">
                <div class="view-header">
                    <h2><i class="fas fa-calendar-week"></i> <span data-lang="ja">ä»Šé€±ã®ã‚·ãƒ•ãƒˆ</span><span data-lang="zh" style="display:none">æœ¬å‘¨æ’ç­</span></h2>
                    <div class="week-nav">
                        <button class="btn-icon" onclick="changeWeek(-1)" title="å‰é€±">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="weekRange"></span>
                        <button class="btn-icon" onclick="changeWeek(1)" title="æ¬¡é€±">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="weekly-schedule-container">
                    <div class="weekly-schedule" id="weeklySchedule">
                        <!-- é€±é–“ã‚·ãƒ•ãƒˆè¡¨ -->
                    </div>
                </div>
            </div>

            <!-- SCHEDULE VIEW -->
            <div class="view" id="scheduleView">
                <div class="view-header">
                    <h2><i class="fas fa-plus-circle"></i> <span data-lang="ja">ã‚·ãƒ•ãƒˆç™»éŒ²</span><span data-lang="zh" style="display:none">æ·»åŠ æ’ç­</span></h2>
                </div>

                <div class="schedule-form">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> <span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å‘˜å·¥</span></label>
                        <select id="scheduleEmployee" class="select-input">
                            <option value=""><span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•ã‚’é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å‘˜å·¥</span></option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-calendar"></i> <span data-lang="ja">æ—¥ä»˜</span><span data-lang="zh" style="display:none">æ—¥æœŸ</span></label>
                        <input type="date" id="scheduleDate" class="input-field">
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-clock"></i> <span data-lang="ja">å‹¤å‹™æ™‚é–“</span><span data-lang="zh" style="display:none">å·¥ä½œæ—¶é—´</span></label>
                        <div class="time-range-group">
                            <div class="time-range-inputs">
                                <input type="time" id="scheduleStart" class="input-field" value="12:00">
                                <span class="time-separator">ã€œ</span>
                                <input type="time" id="scheduleEnd" class="input-field" value="00:00">
                            </div>
                            <div class="quick-time-buttons">
                                <button type="button" class="time-preset" onclick="setTimePreset('12:00', '00:00')">
                                    <span data-lang="ja">å…¨æ—¥</span>
                                    <span data-lang="zh" style="display:none">å…¨å¤©</span>
                                </button>
                                <button type="button" class="time-preset" onclick="setTimePreset('18:00', '00:00')">
                                    <span data-lang="ja">å¤œå‹¤</span>
                                    <span data-lang="zh" style="display:none">æ™šç­</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> <span data-lang="ja">ç¨®é¡</span><span data-lang="zh" style="display:none">ç±»å‹</span></label>
                        <div class="type-selector">
                            <button type="button" class="type-btn active" data-type="work" onclick="selectScheduleType('work')">
                                <i class="fas fa-briefcase"></i>
                                <span data-lang="ja">å‹¤å‹™</span>
                                <span data-lang="zh" style="display:none">å·¥ä½œ</span>
                            </button>
                            <button type="button" class="type-btn" data-type="rest" onclick="selectScheduleType('rest')">
                                <i class="fas fa-umbrella-beach"></i>
                                <span data-lang="ja">ä¼‘ã¿</span>
                                <span data-lang="zh" style="display:none">ä¼‘æ¯</span>
                            </button>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button type="button" class="btn-primary" onclick="addSchedule()">
                            <i class="fas fa-check"></i> 
                            <span data-lang="ja">ç™»éŒ²</span>
                            <span data-lang="zh" style="display:none">æ·»åŠ </span>
                        </button>
                        <button type="button" class="btn-secondary" onclick="showQuickWeekModal()">
                            <i class="fas fa-calendar-week"></i> 
                            <span data-lang="ja">é€±ä¸€æ‹¬</span>
                            <span data-lang="zh" style="display:none">æ•´å‘¨æ’ç­</span>
                        </button>
                        <button type="button" class="btn-secondary btn-rest-day" onclick="showSetRestDaysModal()">
                            <i class="fas fa-umbrella-beach"></i> 
                            <span data-lang="ja">ä¼‘æ—¥è¨­å®š</span>
                            <span data-lang="zh" style="display:none">è®¾ç½®ä¼‘æ¯æ—¥</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Quick Actions Bar -->
        <div class="quick-actions-bar no-print">
            <button type="button" class="quick-action" onclick="showTodaySchedule()">
                <i class="fas fa-calendar-day"></i>
                <span data-lang="ja">ä»Šæ—¥</span>
                <span data-lang="zh" style="display:none">ä»Šå¤©</span>
            </button>
            <button type="button" class="quick-action" onclick="showStats()">
                <i class="fas fa-chart-bar"></i>
                <span data-lang="ja">çµ±è¨ˆ</span>
                <span data-lang="zh" style="display:none">ç»Ÿè®¡</span>
            </button>
            <button type="button" class="quick-action" onclick="printAllSchedule()">
                <i class="fas fa-print"></i>
                <span data-lang="ja">å°åˆ·</span>
                <span data-lang="zh" style="display:none">æ‰“å°</span>
            </button>
        </div>
    </div>

    <!-- MODALS -->
    <!-- Employee Detail Modal -->
    <div class="modal" id="employeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalEmployeeName"></h3>
                <button type="button" class="modal-close" onclick="closeModal('employeeModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="employee-detail-info">
                    <div class="employee-basic">
                        <div class="info-row">
                            <span class="label" data-lang="ja">è·ç¨®</span>
                            <span class="label" data-lang="zh" style="display:none">èŒä½</span>
                            <span class="value" id="modalEmployeePosition"></span>
                        </div>
                        <div class="info-row">
                            <span class="label" data-lang="ja">ä»Šé€±æ™‚é–“</span>
                            <span class="label" data-lang="zh" style="display:none">æœ¬å‘¨å·¥æ—¶</span>
                            <span class="value" id="modalWeekHours">0æ™‚é–“</span>
                        </div>
                        <div class="info-row">
                            <span class="label" data-lang="ja">ä»Šæœˆæ™‚é–“</span>
                            <span class="label" data-lang="zh" style="display:none">æœ¬æœˆå·¥æ—¶</span>
                            <span class="value" id="modalMonthHours">0æ™‚é–“</span>
                        </div>
                    </div>

                    <div class="week-summary">
                        <h4><i class="fas fa-calendar-week"></i> <span data-lang="ja">ä»Šé€±ã®ã‚·ãƒ•ãƒˆ</span><span data-lang="zh" style="display:none">æœ¬å‘¨æ’ç­</span></h4>
                        <div class="week-days" id="employeeWeekDays">
                            <!-- é€±é–“ã‚·ãƒ•ãƒˆè¡¨ç¤º -->
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-action" onclick="editEmployeeSchedule()">
                            <i class="fas fa-edit"></i> 
                            <span data-lang="ja">ç·¨é›†</span>
                            <span data-lang="zh" style="display:none">ç¼–è¾‘</span>
                        </button>
                        
                        <div class="split-buttons">
                            <button type="button" class="btn-action" onclick="copyScheduleAsText()">
                                <i class="fas fa-copy"></i> 
                                <span data-lang="ja">ã‚³ãƒ”ãƒ¼</span>
                                <span data-lang="zh" style="display:none">å¤åˆ¶</span>
                            </button>
                            <button type="button" class="btn-action" onclick="printEmployeeSchedule()">
                                <i class="fas fa-print"></i> 
                                <span data-lang="ja">å°åˆ·</span>
                                <span data-lang="zh" style="display:none">æ‰“å°</span>
                            </button>
                        </div>
                        
                        <button type="button" class="btn-action btn-danger" onclick="deleteCurrentEmployee()">
                            <i class="fas fa-trash"></i> 
                            <span data-lang="ja">å‰Šé™¤</span>
                            <span data-lang="zh" style="display:none">åˆ é™¤</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div class="modal" id="addEmployeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> <span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•è¿½åŠ </span><span data-lang="zh" style="display:none">æ·»åŠ å‘˜å·¥</span></h3>
                <button type="button" class="modal-close" onclick="closeModal('addEmployeeModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="text" id="newEmployeeName" class="input-field" placeholder="åå‰ã‚’å…¥åŠ›" autofocus>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-briefcase"></i> <span data-lang="ja">è·ç¨®</span><span data-lang="zh" style="display:none">èŒä½</span></label>
                    <div class="position-select">
                        <button type="button" class="position-option active" data-position="å‰å°/æœåŠ¡åŒº" onclick="selectPosition(this)">
                            <i class="fas fa-door-open"></i>
                            <span data-lang="ja">ãƒ•ãƒ­ãƒ³ãƒˆ</span>
                            <span data-lang="zh" style="display:none">å‰å°</span>
                        </button>
                        <button type="button" class="position-option" data-position="å¨æˆ¿åŒº" onclick="selectPosition(this)">
                            <i class="fas fa-utensils"></i>
                            <span data-lang="ja">å¨æˆ¿</span>
                            <span data-lang="zh" style="display:none">å¨æˆ¿</span>
                        </button>
                    </div>
                </div>
                <button type="button" class="btn-primary full-width" onclick="addEmployee()">
                    <i class="fas fa-plus"></i> 
                    <span data-lang="ja">è¿½åŠ </span>
                    <span data-lang="zh" style="display:none">æ·»åŠ </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Quick Week Schedule Modal -->
    <div class="modal" id="quickWeekModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-week"></i> <span data-lang="ja">é€±ä¸€æ‹¬ç™»éŒ²</span><span data-lang="zh" style="display:none">æ•´å‘¨æ’ç­</span></h3>
                <button type="button" class="modal-close" onclick="closeModal('quickWeekModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="quick-week-options">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> <span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å‘˜å·¥</span></label>
                        <select id="quickWeekEmployee" class="select-input">
                            <option value=""><span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•ã‚’é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å‘˜å·¥</span></option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-clock"></i> <span data-lang="ja">å‹¤å‹™æ™‚é–“</span><span data-lang="zh" style="display:none">å·¥ä½œæ—¶é—´</span></label>
                        <div class="time-group">
                            <input type="time" id="quickWeekStart" class="input-field" value="08:00">
                            <span class="time-separator">ã€œ</span>
                            <input type="time" id="quickWeekEnd" class="input-field" value="17:00">
                        </div>
                        <div class="quick-time-buttons">
                            <button type="button" class="time-preset" onclick="setQuickTimePreset('08:00', '17:00')">
                                <span data-lang="ja">æœ</span>
                                <span data-lang="zh" style="display:none">æ—©ç­</span>
                            </button>
                            <button type="button" class="time-preset" onclick="setQuickTimePreset('12:00', '21:00')">
                                <span data-lang="ja">æ˜¼</span>
                                <span data-lang="zh" style="display:none">ä¸­ç­</span>
                            </button>
                            <button type="button" class="time-preset" onclick="setQuickTimePreset('09:00', '18:00')">
                                <span data-lang="ja">å…¨æ—¥</span>
                                <span data-lang="zh" style="display:none">å…¨å¤©</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-calendar-check"></i> <span data-lang="ja">å‹¤å‹™æ—¥é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å·¥ä½œæ—¥</span></label>
                        <div class="weekdays-selector" id="weekdaysSelector">
                            <!-- æ›œæ—¥é¸æŠ -->
                        </div>
                        <div class="quick-day-buttons">
                            <button type="button" class="day-preset" onclick="setAllWeekdays()">
                                <span data-lang="ja">å…¨é¸æŠ</span>
                                <span data-lang="zh" style="display:none">å…¨é€‰</span>
                            </button>
                            <button type="button" class="day-preset" onclick="clearWeekdays()">
                                <span data-lang="ja">è§£é™¤</span>
                                <span data-lang="zh" style="display:none">æ¸…é™¤</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-primary" onclick="applyQuickWeekSchedule()">
                        <i class="fas fa-check"></i> 
                        <span data-lang="ja">é©ç”¨</span>
                        <span data-lang="zh" style="display:none">åº”ç”¨</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Set Rest Days Modal -->
    <div class="modal" id="setRestDaysModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-umbrella-beach"></i> <span data-lang="ja">ä¼‘æ—¥è¨­å®š</span><span data-lang="zh" style="display:none">è®¾ç½®ä¼‘æ¯æ—¥</span></h3>
                <button type="button" class="modal-close" onclick="closeModal('setRestDaysModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="rest-days-options">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> <span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å‘˜å·¥</span></label>
                        <select id="restDaysEmployee" class="select-input">
                            <option value=""><span data-lang="ja">ã‚¹ã‚¿ãƒƒãƒ•ã‚’é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©å‘˜å·¥</span></option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-calendar-check"></i> <span data-lang="ja">ä¼‘æ—¥é¸æŠ</span><span data-lang="zh" style="display:none">é€‰æ‹©ä¼‘æ¯æ—¥</span></label>
                        <div class="weekdays-selector" id="restDaysSelector">
                            <!-- ä¼‘æ—¥é¸æŠ -->
                        </div>
                        <div class="quick-day-buttons">
                            <button type="button" class="day-preset" onclick="clearRestDays()">
                                <span data-lang="ja">è§£é™¤</span>
                                <span data-lang="zh" style="display:none">æ¸…é™¤</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-primary" onclick="applyRestDays()">
                        <i class="fas fa-umbrella-beach"></i> 
                        <span data-lang="ja">é©ç”¨</span>
                        <span data-lang="zh" style="display:none">åº”ç”¨</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Today's Schedule Modal -->
    <div class="modal" id="todayModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-day"></i> <span data-lang="ja">ä»Šæ—¥ã®ã‚·ãƒ•ãƒˆ</span><span data-lang="zh" style="display:none">ä»Šæ—¥æ’ç­</span></h3>
                <button type="button" class="modal-close" onclick="closeModal('todayModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="today-list" id="todayList">
                    <!-- ä»Šæ—¥ã®ã‚·ãƒ•ãƒˆãƒªã‚¹ãƒˆ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Modal -->
    <div class="modal" id="statsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-chart-bar"></i> <span data-lang="ja">å‹¤å‹™çµ±è¨ˆ</span><span data-lang="zh" style="display:none">å·¥æ—¶ç»Ÿè®¡</span></h3>
                <button type="button" class="modal-close" onclick="closeModal('statsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="stats-grid" id="statsGrid">
                    <!-- çµ±è¨ˆæƒ…å ± -->
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Schedule Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> <span data-lang="ja">ã‚·ãƒ•ãƒˆç·¨é›†</span><span data-lang="zh" style="display:none">ç¼–è¾‘æ’ç­</span></h3>
                <button type="button" class="modal-close" onclick="closeModal('editModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="editScheduleContent">
                    <!-- ç·¨é›†å†…å®¹ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Configuration -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB6C3s4EAPEx0GBLnBXAz4aYJfoCBEyofc",
            authDomain: "employee-schedule-893f5.firebaseapp.com",
            databaseURL: "https://employee-schedule-893f5-default-rtdb.firebaseio.com",
            projectId: "employee-schedule-893f5",
            storageBucket: "employee-schedule-893f5.firebasestorage.app",
            messagingSenderId: "377051530021",
            appId: "1:377051530021:web:e3341a1a7bcdc89ad810cc"
        };
        
        try {
            firebase.initializeApp(firebaseConfig);
            window.database = firebase.database();
            
            // æ¥ç¶šçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
            window.database.ref('.info/connected').on('value', (snap) => {
                const status = document.getElementById('connectionStatus');
                if (snap.val() === true) {
                    status.innerHTML = '<i class="fas fa-wifi"></i><span data-lang="ja">æ¥ç¶šæ¸ˆã¿</span><span data-lang="zh" style="display:none">å·²è¿æ¥</span>';
                    status.className = 'connection-status connected';
                } else {
                    status.innerHTML = '<i class="fas fa-wifi-slash"></i><span data-lang="ja">æ¥ç¶šåˆ‡ã‚Œ</span><span data-lang="zh" style="display:none">æœªè¿æ¥</span>';
                    status.className = 'connection-status disconnected';
                }
            });
            
            console.log("âœ… Firebase initialized");
        } catch (error) {
            console.error("âŒ Firebase initialization error:", error);
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.getElementById('loadingScreen').style.display = 'none';
            }, 500);
        });
    </script>

    <!-- Main JavaScript -->
    <script src="app.js"></script>
</body>
</html>